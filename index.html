<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Weather Now ‚Äî Enhanced Version</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
  <style>
    body{margin:0;font-family:Inter,system-ui,sans-serif;background:linear-gradient(180deg,#0a192f,#172a45);color:white;min-height:100vh;padding:20px;}
    h1{text-align:center;margin-bottom:10px;}
    .container{max-width:1200px;margin:0 auto;}
    .search-bar{display:flex;justify-content:center;gap:10px;margin-bottom:20px;}
    input,button,select{padding:10px;border-radius:8px;border:none;}
    input{width:200px;}
    button{cursor:pointer;background:#3b82f6;color:white;}
    .weather-section{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px;}
    .card{background:rgba(255,255,255,0.1);padding:20px;border-radius:12px;text-align:center;backdrop-filter:blur(8px);}
    .forecast,.comparison{margin-top:30px;}
    .forecast-grid{display:flex;overflow-x:auto;gap:10px;padding-bottom:10px;}
    .forecast-item{flex:0 0 auto;background:rgba(255,255,255,0.1);padding:10px;border-radius:10px;min-width:100px;text-align:center;}
    #map{height:300px;border-radius:12px;margin-top:20px;}
  </style>
</head>
<body>
  <div class="container">
    <h1>üå§Ô∏è Weather Now ‚Äî Enhanced</h1>
    <div class="search-bar">
      <input id="cityInput1" placeholder="Enter City 1" />
      <input id="cityInput2" placeholder="Enter City 2 (optional)" />
      <select id="unitsSelect">
        <option value="metric">¬∞C</option>
        <option value="imperial">¬∞F</option>
      </select>
      <button id="searchBtn">Search</button>
    </div>

    <div class="weather-section">
      <div class="card" id="weather1">Weather data for city 1 will appear here</div>
      <div class="card" id="weather2">Weather data for city 2 will appear here</div>
    </div>

    <div class="forecast">
      <h2>5-Day Forecast</h2>
      <div class="forecast-grid" id="forecastGrid"></div>
    </div>

    <div class="comparison">
      <h2>City Comparison</h2>
      <div id="comparisonResult">Enter two cities to compare their weather.</div>
    </div>

    <div id="map"></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script>
    const API_KEY = '99917bbf786bc9de41ebd51779b26b2c';
    const weather1 = document.getElementById('weather1');
    const weather2 = document.getElementById('weather2');
    const forecastGrid = document.getElementById('forecastGrid');
    const comparisonResult = document.getElementById('comparisonResult');

    const map = L.map('map').setView([20, 78], 4);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '¬© OpenStreetMap' }).addTo(map);

    async function fetchWeather(city, units){
      const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${API_KEY}&units=${units}`);
      if(!res.ok) throw new Error('City not found');
      return res.json();
    }

    async function fetchForecast(city, units){
      const res = await fetch(`https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${API_KEY}&units=${units}`);
      const data = await res.json();
      forecastGrid.innerHTML = '';
      for(let i=0;i<data.list.length;i+=8){
        const item=data.list[i];
        const day=new Date(item.dt*1000).toLocaleDateString('en-US',{weekday:'short'});
        forecastGrid.innerHTML+=`<div class="forecast-item"><div>${day}</div><img src="https://openweathermap.org/img/wn/${item.weather[0].icon}.png"/><div>${Math.round(item.main.temp_min)}¬∞ / ${Math.round(item.main.temp_max)}¬∞</div><div>${item.weather[0].main}</div></div>`;
      }
    }

    function renderWeather(data, element, units){
      const unitSymbol = units==='metric'?'¬∞C':'¬∞F';
      element.innerHTML = `
        <h2>${data.name}, ${data.sys.country}</h2>
        <img src="https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png" />
        <h3>${Math.round(data.main.temp)}${unitSymbol}</h3>
        <p>${data.weather[0].description}</p>
        <p>Feels Like: ${Math.round(data.main.feels_like)}${unitSymbol}</p>
        <p>Humidity: ${data.main.humidity}%</p>
        <p>Wind: ${data.wind.speed}${units==='metric'?' m/s':' mph'}</p>
        <p><strong>Max:</strong> ${Math.round(data.main.temp_max)}${unitSymbol} | <strong>Min:</strong> ${Math.round(data.main.temp_min)}${unitSymbol}</p>
      `;
    }

    document.getElementById('searchBtn').addEventListener('click', async()=>{
      const city1=document.getElementById('cityInput1').value.trim();
      const city2=document.getElementById('cityInput2').value.trim();
      const units=document.getElementById('unitsSelect').value;
      if(!city1)return alert('Please enter at least one city.');
      try{
        const data1=await fetchWeather(city1,units);
        renderWeather(data1,weather1,units);
        map.setView([data1.coord.lat,data1.coord.lon],8);
        fetchForecast(city1,units);

        if(city2){
          const data2=await fetchWeather(city2,units);
          renderWeather(data2,weather2,units);
          compareCities(data1,data2,units);
        } else {
          weather2.innerHTML='Weather data for city 2 will appear here';
          comparisonResult.textContent='Enter two cities to compare their weather.';
        }
      }catch(err){alert(err.message);}
    });

    function compareCities(c1,c2,units){
      const unitSymbol = units==='metric'?'¬∞C':'¬∞F';
      comparisonResult.innerHTML = `
        <p>${c1.name}: ${Math.round(c1.main.temp)}${unitSymbol}, Humidity ${c1.main.humidity}%</p>
        <p>${c2.name}: ${Math.round(c2.main.temp)}${unitSymbol}, Humidity ${c2.main.humidity}%</p>
        <p><strong>${c1.main.temp>c2.main.temp?c1.name:c2.name}</strong> is warmer today.</p>
      `;
    }
  </script>
</body>
</html>
